name: "automerge"

permissions:
  pull-requests: write
  contents: write

on: pull_request_target

jobs:
  approve:
    uses: "./.github/workflows/auto-approve.yml"

    if: ${{ github.actor == 'dependabot[bot]' }}

    with:
      pullRequestUrl: "${{ github.event.pull_request.html_url }}"

    secrets:
      envPAT: "${{ secrets.GITHUB_TOKEN }}"
  automerge:
    needs: "approve"

    uses: "./.github/workflows/auto-merge.yml"

    with:
      pullRequestUrl: "${{ github.event.pull_request.html_url }}"

    secrets:
      envPAT: "${{ secrets.GITHUB_TOKEN }}"
  test:
    name: "Test"

    runs-on: "ubuntu-22.04"
    timeout-minutes: 10
    continue-on-error: false

    steps:
      - name: "print something about github info"
        run: "echo 'repo-event-workflow-ref: ${{ github.repository }}-${{ github.event_name }}-${{ github.workflow }}-${{ github.base_ref || github.run_id }}-${{ github.head_ref || github.run_id }}-${{ github.ref }}'"
